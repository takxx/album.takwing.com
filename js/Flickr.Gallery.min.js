!function(e){var t,i;e.fn.flickrGallery=function(i){var n=e.extend({},t.settings,i);t.Setup(e(this),n)},t={settings:{Key:"dd7e89c7f0c07a951c30b34d7a013486",Secret:"d792124bcd9f09bb",User:"130110901@N08",PhotoSet:"72157650384280721",Speed:400,navigation:1,keyboard:1,numberEl:1},photoDetails:[],activeEl:0,bgThumb:"",thumbTitle:"",plusIcon:"",thumb:"",galleryDiv:"",vbDiv:"",closeBtn:"",nextBtn:"",prevBtn:"",resizeBtn:"",titleViewBox:"",panelViewBox:"",loader:"",cntViewBox:"",vbDetails:"",vbDetailsBottom:10,browserSize:"",Setup:function(n,o){t.galleryDiv=n.append('<ul class="entries-columns"></ul>').find("ul"),i=new Flickr({api_key:o.Key}),i.photosets.getPhotos({photoset_id:o.PhotoSet,extras:"url_q, url_c, owner_name, views, date_upload"},function(i,n){if(i)console.log(i);else{var a=n.photoset;t.photoDetails=a.photo,t.buildThumb(),t.thumb.on("click",function(i){i.preventDefault(),t.setupViewBox(e(this),o)})}})},buildThumb:function(){for(var i,n,o=0;o<t.photoDetails.length;o++)n=t.photoDetails[o],i=t.galleryDiv.append("<li id="+o+"><a href='"+n.url_o+"'><img src='"+n.url_m+"' alt='"+n.title+"' /><div class='bg'></div><div class='content'></div><i class='show' data-href='"+n.url_o+"' data-photoid='"+n.id+"'>VIEW IT</i></a></li>").find("li .content").last(),""!==n.title&&i.append("<h4>"+n.title+"</h4>");t.galleryDiv.find("li img").on("load",function(){e(this).parents("li").animate({opacity:1},255)}),t.bgThumb=t.galleryDiv.find(".bg"),t.plusIcon=t.galleryDiv.find(".show"),t.thumbTitle=t.galleryDiv.find("li .content"),t.thumb=t.galleryDiv.find("li"),t.mouseEvents()},mouseEvents:function(){var i=t.plusIcon.first().css("top"),n=t.thumbTitle.first().css("top");t.thumb.on("mouseover",function(){t.thumbHover(e(this),"55%","30%",1)}),t.thumb.on("mouseleave",function(){t.thumbHover(e(this),i,n,0)})},thumbHover:function(e,t,i,n){e.find(".bg").stop(!0,!1).animate({opacity:n},350,"easeInOutCubic").parent().find(".show").stop(!0,!1).animate({top:t,opacity:n},450,"easeOutElastic").parent().find(".content").stop(!0,!1).animate({top:i,opacity:n},450,"easeOutElastic")},setupViewBox:function(e,i){t.activeEl=e.attr("id"),t.viewBoxHTML(i),t.viewBoxStart(i)},viewBoxHTML:function(i){e("body").append('<div class="viewbox"><div class="panel"><h3>Title of Picture</h3><a href="#" class="resize icon"></a><a href="#" class="close icon"></a></div><div class="media_c"></div><div class="details"></div><div class="loader"></div></div>'),t.vbDiv=e(".viewbox"),i.navigation&&t.vbDiv.append('<a href="#" class="prev icon"></a><a href="#" class="next icon"></a>'),t.panelViewBox=t.vbDiv.find(".panel"),t.titleViewBox=t.vbDiv.find("h3"),t.closeBtn=t.vbDiv.find(".close"),t.resizeBtn=t.vbDiv.find(".resize"),t.loader=t.vbDiv.find(".loader"),t.cntViewBox=t.vbDiv.find(".media_c"),t.nextBtn=t.vbDiv.find(".next"),t.prevBtn=t.vbDiv.find(".prev"),t.vbDetails=t.vbDiv.find(".details"),t.vbDetailsBottom=t.vbDetails.css("bottom"),i.numberEl&&(t.numberDiv=t.panelViewBox.prepend('<div class="number"></div>').find(".number"))},viewBoxStart:function(e){t.vbDiv.fadeIn(e.Speed),t.panelViewBox.fadeIn(e.Speed).animate({top:0},e.Speed),t.loadCnt(e)},loadCnt:function(e){t.loader.fadeIn(e.Speed/2),t.titleViewBox.text(t.photoDetails[t.activeEl].title);var i=new Image;i.onload=function(){t.cntViewBox.append('<img src="'+i.src+'" alt="'+t.photoDetails[t.activeEl].title+'" />'),t.resizeViewBox(e,"m"),t.loader.fadeOut(e.Speed/2)},i.src=t.photoDetails[t.activeEl].url_o,e.navigation&&t.navSupport(e),e.numberEl&&t.numberDiv.text(1+parseInt(t.activeEl)+"/"+t.photoDetails.length),t.setDetails(e)},setDetails:function(e){i.photos.getInfo({photo_id:t.photoDetails[t.activeEl].id},function(i,n){if(i)console.log(i);else{var o=n.photo,a=t.getTheDate(o.dates.posted);t.vbDetails.contents().remove().addBack().append("<h2>"+o.title._content+"</h2><p>"+o.description._content+'</p><div class="date"><span>'+a.day+" "+a.month+", "+a.year+'</span></div><div class="author">Published by: '+o.owner.realname+"</div>"),t.vbDetails.stop(!0,!1).animate({bottom:t.vbDetailsBottom},e.Speed,"easeInOutCirc")}})},navSupport:function(i){var n=parseInt(t.activeEl)+1,o=parseInt(t.activeEl)-1,a=t.photoDetails.length;a>n?t.nextBtn.fadeIn(i.Speed).off().on("click",function(e){e.preventDefault(),t.activeEl=n,t.changeSlide(i,"-=")}):t.nextBtn.fadeOut(i.Speed),o>-1?t.prevBtn.fadeIn(i.Speed).off().on("click",function(e){e.preventDefault(),t.activeEl=o,t.changeSlide(i,"+=")}):t.prevBtn.fadeOut(i.Speed),t.closeBtn.off().on("click",function(e){e.preventDefault(),t.closeViewBox(i)}),t.resizeBtn.off().on("click",function(e){e.preventDefault(),t.resizeBtn.is(".active")?(t.resizeBtn.toggleClass("active",!1),t.exitFullscreen(t.vbDiv)):(t.resizeBtn.toggleClass("active",!0),t.initFullscreen(t.vbDiv))}),e(document.documentElement).off().on("keyup",function(e){37==e.keyCode&&t.prevBtn.is(":visible")&&(t.activeEl=o,t.changeSlide(i,"+=")),39==e.keyCode&&t.nextBtn.is(":visible")&&(t.activeEl=n,t.changeSlide(i,"-=")),27==e.keyCode&&t.closeViewBox(i)})},changeSlide:function(e,i){t.vbDetails.animate({bottom:-t.vbDetails.height()},e.Speed/2),t.cntViewBox.animate({left:i+t.browserSize[1],opacity:0},e.Speed,function(){t.cntViewBox.find("img").remove(),"-="==i?t.cntViewBox.css("left",t.browserSize[1]):t.cntViewBox.css("left",-t.browserSize[1]),t.loadCnt(e)})},closeViewBox:function(e){t.cntViewBox.animate({height:0,top:t.browserSize[0]/2,width:0,left:t.browserSize[1]/2},e.Speed,"easeOutExpo"),t.vbDiv.fadeOut(e.Speed,function(){t.vbDiv.remove(),t.exitFullscreen(t.vbDiv)})},resizeViewBox:function(i){t.updateBrowserSize();var n=t.photoDetails[t.activeEl],o=n.height_o,a=n.width_o,l=t.scale(t.browserSize[1],t.browserSize[0],a,o);t.cntViewBox.animate({top:t.browserSize[0]/2-l[1]/2,height:l[1],left:t.browserSize[1]/2-l[0]/2,width:l[0],opacity:1},i.Speed,"easeOutBack"),e(window).on("resize",function(e){e.preventDefault(),t.updateBrowserSize(),l=t.scale(t.browserSize[1],t.browserSize[0],a,o),t.cntViewBox.css({top:t.browserSize[0]/2-l[1]/2,height:l[1],left:t.browserSize[1]/2-l[0]/2,width:l[0]})}),t.browserSize[0]<o||t.browserSize[1]<a?t.cntViewBox.draggable({disabled:!1}):t.cntViewBox.draggable({disabled:!0})},initFullscreen:function(e){e.attr("id","flscreen");var t=document.getElementById("flscreen");t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),e("#flscreen").removeAttr("id")},updateBrowserSize:function(){var e=new Array;e[0]=document.documentElement.clientHeight,e[1]=document.documentElement.clientWidth,t.browserSize=e},scale:function(e,t,i,n){var o=n/i;return i>=e&&1>=o?(i=e,n=i*o):n>=t&&(n=t,i=n/o),[i,n]},getTheDate:function(e){var t=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),i=new Date(1e3*parseInt(e)),n={day:i.getDate(),month:t[i.getMonth()],year:i.getFullYear()};return n}}}(jQuery);
